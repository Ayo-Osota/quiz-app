[
  {
    "id": 1,
    "question": "What is the correct basic syntax to apply an aggregate function to a column in SQL?",
    "options": [
      "SELECT column_name FROM table_name AGGREGATE(sum);",
      "SELECT aggregate_function(column_name) FROM table_name;",
      "AGGREGATE(column_name) SELECT FROM table_name;",
      "SELECT FROM table_name WHERE aggregate_function(column_name);"
    ],
    "correctAnswer": "SELECT aggregate_function(column_name) FROM table_name;",
    "explanation": "Aggregate functions are called in the SELECT clause using the form SELECT aggregate_function(column_name) FROM table_name."
  },
  {
    "id": 2,
    "question": "Which aggregate function would you use to count the total number of rows in the employees table?",
    "options": ["SUM(*)", "COUNT(*)", "AVG(*)", "TOTAL(*)"],
    "correctAnswer": "COUNT(*)",
    "explanation": "COUNT(*) returns the number of rows in a table or result set; it's commonly used to count employees or records."
  },
  {
    "id": 3,
    "question": "Which aggregate function returns the total sales amount from a sales table?",
    "options": [
      "MAX(sale_amount)",
      "SUM(sale_amount)",
      "COUNT(sale_amount)",
      "AVG(sale_amount)"
    ],
    "correctAnswer": "SUM(sale_amount)",
    "explanation": "SUM(sale_amount) adds all values in the sale_amount column to give the total sales."
  },
  {
    "id": 4,
    "question": "How do you calculate the average salary across all employees?",
    "options": [
      "SELECT MEDIAN(salary) FROM employees;",
      "SELECT AVG(salary) AS average_salary FROM employees;",
      "SELECT SUM(salary) / COUNT(*) FROM departments;",
      "SELECT TOTAL(salary) FROM employees;"
    ],
    "correctAnswer": "SELECT AVG(salary) AS average_salary FROM employees;",
    "explanation": "AVG(salary) computes the arithmetic mean of the salary column; aliasing with AS average_salary gives a readable column name."
  },
  {
    "id": 5,
    "question": "Which pair of aggregate functions returns the highest and lowest salary respectively?",
    "options": [
      "MIN(salary) and MAX(salary)",
      "SUM(salary) and AVG(salary)",
      "MAX(salary) and MIN(salary)",
      "COUNT(salary) and SUM(salary)"
    ],
    "correctAnswer": "MAX(salary) and MIN(salary)",
    "explanation": "MAX(salary) returns the highest salary and MIN(salary) returns the lowest; order in the question is highest then lowest."
  },
  {
    "id": 6,
    "question": "What is the purpose of the GROUP BY clause in SQL?",
    "options": [
      "To filter individual rows before aggregation",
      "To group rows that have the same values so aggregate functions can be applied per group",
      "To delete duplicate rows from a table",
      "To join two tables based on a key"
    ],
    "correctAnswer": "To group rows that have the same values so aggregate functions can be applied per group",
    "explanation": "GROUP BY groups rows sharing the same values in specified columns, enabling aggregate calculations for each group (e.g., COUNT per department)."
  },
  {
    "id": 7,
    "question": "Which query best counts the number of employees in each department?",
    "options": [
      "SELECT department_id, COUNT(*) AS employee_count FROM employees GROUP BY department_id;",
      "SELECT COUNT(*) FROM employees WHERE department_id;",
      "SELECT department_id FROM employees;",
      "SELECT department_id, SUM(employee_id) FROM employees;"
    ],
    "correctAnswer": "SELECT department_id, COUNT(*) AS employee_count FROM employees GROUP BY department_id;",
    "explanation": "Grouping by department_id and using COUNT(*) returns the number of employees per department."
  },
  {
    "id": 8,
    "question": "Which rule must be followed for columns in the SELECT clause when GROUP BY is used?",
    "options": [
      "All columns in SELECT must be aggregate functions",
      "Any column in SELECT that is not an aggregate must appear in the GROUP BY clause",
      "GROUP BY can only include aggregated expressions",
      "SELECT cannot contain non-aggregated columns when GROUP BY is present"
    ],
    "correctAnswer": "Any column in SELECT that is not an aggregate must appear in the GROUP BY clause",
    "explanation": "SQL requires non-aggregated columns listed in SELECT to be included in GROUP BY so the DB knows how to group results."
  },
  {
    "id": 9,
    "question": "Where should the GROUP BY clause appear in the order of SQL clauses?",
    "options": [
      "After HAVING and ORDER BY",
      "Before WHERE and after ORDER BY",
      "After WHERE and before HAVING or ORDER BY",
      "At the very beginning of the query"
    ],
    "correctAnswer": "After WHERE and before HAVING or ORDER BY",
    "explanation": "The correct order is ... WHERE → GROUP BY → HAVING → ORDER BY. GROUP BY groups rows after filtering and before grouping filters or final ordering."
  },
  {
    "id": 10,
    "question": "What is the purpose of the HAVING clause?",
    "options": [
      "To filter individual rows before aggregation",
      "To rename grouped columns",
      "To filter groups created by GROUP BY based on aggregate conditions",
      "To order the final result set"
    ],
    "correctAnswer": "To filter groups created by GROUP BY based on aggregate conditions",
    "explanation": "HAVING filters group results (e.g., departments with COUNT(*) > 5); WHERE cannot filter on aggregate results."
  },
  {
    "id": 11,
    "question": "Which query finds departments with more than 5 employees?",
    "options": [
      "SELECT department_id FROM employees WHERE COUNT(*) > 5;",
      "SELECT department_id, COUNT(*) AS employee_count FROM employees GROUP BY department_id HAVING COUNT(*) > 5;",
      "SELECT department_id, COUNT(*) FROM employees ORDER BY COUNT(*) > 5;",
      "SELECT department_id FROM employees GROUP BY department_id WHERE COUNT(*) > 5;"
    ],
    "correctAnswer": "SELECT department_id, COUNT(*) AS employee_count FROM employees GROUP BY department_id HAVING COUNT(*) > 5;",
    "explanation": "You must GROUP BY department_id and use HAVING COUNT(*) > 5 to filter groups with more than five employees."
  },
  {
    "id": 12,
    "question": "Which query returns products with total sales exceeding $10,000?",
    "options": [
      "SELECT product_id FROM sales WHERE SUM(sales_amount) > 10000;",
      "SELECT product_id, SUM(sales_amount) AS total_sales FROM sales GROUP BY product_id HAVING SUM(sales_amount) > 10000;",
      "SELECT product_id, SUM(sales_amount) FROM sales ORDER BY total_sales > 10000;",
      "SELECT product_id FROM sales GROUP BY product_id WHERE SUM(sales_amount) > 10000;"
    ],
    "correctAnswer": "SELECT product_id, SUM(sales_amount) AS total_sales FROM sales GROUP BY product_id HAVING SUM(sales_amount) > 10000;",
    "explanation": "Aggregate SUM per product with GROUP BY then filter groups using HAVING SUM(...) > 10000 to find products exceeding the threshold."
  },
  {
    "id": 13,
    "question": "Can you use WHERE to filter rows based on an aggregate like SUM(sales_amount)?",
    "options": [
      "Yes, WHERE can filter on aggregates directly",
      "No, aggregate conditions must be applied using HAVING after GROUP BY",
      "Yes, but only in MySQL",
      "No, filtering aggregates is impossible"
    ],
    "correctAnswer": "No, aggregate conditions must be applied using HAVING after GROUP BY",
    "explanation": "WHERE filters individual rows before grouping; it cannot reference aggregates. Use HAVING to filter by aggregate results."
  },
  {
    "id": 14,
    "question": "Is it valid to use GROUP BY without any aggregate functions in the SELECT clause, and what is the typical effect?",
    "options": [
      "No, GROUP BY always requires aggregates",
      "Yes, GROUP BY can be used to collapse duplicate combinations of grouped columns (acting like DISTINCT on those columns)",
      "No, it will cause syntax error in all SQL engines",
      "Yes, but it always returns an empty set"
    ],
    "correctAnswer": "Yes, GROUP BY can be used to collapse duplicate combinations of grouped columns (acting like DISTINCT on those columns)",
    "explanation": "GROUP BY without aggregates can group rows by column values—similar to DISTINCT on those columns—though it's most commonly used with aggregate functions."
  },
  {
    "id": 15,
    "question": "Which clause is used to sort the results after grouping and aggregating?",
    "options": ["WHERE", "HAVING", "ORDER BY", "GROUP ORDER"],
    "correctAnswer": "ORDER BY",
    "explanation": "ORDER BY is applied after GROUP BY and HAVING to sort the final result set (e.g., ORDER BY total_sales DESC)."
  }
]
